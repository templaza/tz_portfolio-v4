!function($){"use strict";$.tppServerList=function(el,options){function serverList(){var pagItems=$tppServer.find(settings.pagSelector+" "+settings.pagItemSelector);pagItems.length&&pagItems.each(function(){var $this=$(this);$this.on("click",function(event){event.preventDefault(),event.stopPropagation(),$tppServer.find(settings.loadingSelector).show(),serverListAjax($this)})})}var $tppServer=$(el),settings=$.extend(!0,$.tppServerList.defaults,options),serverListAjax=function(elPagination){var ajax=settings.ajax;ajax.url=settings.url,ajax.data.view=settings.view,void 0!==elPagination&&(ajax.data.limitstart=elPagination.data("tpp-limitstart")),void 0!==$.fn.tpSerializeObject&&$.extend(ajax.data,$tppServer.find(settings.filListSelector).tpSerializeObject()),settings.formToken&&(ajax.data[settings.formToken]=1),$tppServer.find(settings.filterSelector).hide(),ajax.success=function(result){var exList;result&&result.data&&result.data.html?((exList=$tppServer.find(settings.listSelector)).html(result.data.html),$tppServer.find(settings.pagSelector).html(result.data.pagination),$tppServer.find(settings.filterSelector).show(),exList.find(".modal").on("show.bs.modal",function(){var url,modalBody,iframeHtml;void 0!==$(this).attr("data-iframe")?(modalBody=$(this).find(".modal-body"),iframeHtml=$($(this).attr("data-iframe"))):(url=exList.find('.action-links [data-toggle=modal][href="#'+$(this).attr("id")+'"]').data("url"),modalBody=$(this).find(".modal-body"),(iframeHtml=$(settings.iframeHtml)).attr("src",url)),modalBody.find("iframe").remove(),modalBody.prepend(iframeHtml)}).on("shown.bs.modal",function(){var modal,iframe,modalHeaderHeight,modalFooterHeight,padding,modalBodyHeightOuter,modalBodyHeight;void 0===$(this).attr("data-iframe")&&(modal=$(this),iframe=$(this).find("iframe"),modal.outerHeight(!0),modalHeaderHeight=modal.find("div.modal-header:visible").outerHeight(!0),modalBodyHeightOuter=modal.find("div.modal-body:visible").outerHeight(!0),modalBodyHeight=modal.find("div.modal-body:visible").height(),modalFooterHeight=modal.find("div.modal-footer:visible").outerHeight(!0),padding=modal.position().top,modalBodyHeightOuter=modalBodyHeightOuter-modalBodyHeight,(modalBodyHeight=$(window).height()-2*padding-(modalHeaderHeight+modalFooterHeight+modalBodyHeightOuter))<iframe.height())&&(modal.find(".modal-body").css({"max-height":modalBodyHeight,"overflow-y":"initial"}),iframe.css("max-height",modalBodyHeight-modalBodyHeightOuter))}),serverList(),serverListInstallNow(),$tppServer.find(settings.loadingSelector).hide()):($tppServer.find(settings.errorSelector).show(),$tppServer.find(settings.loadingSelector).hide(),$tppServer.find(settings.filterSelector).show())},ajax.error=function(){$tppServer.find(settings.filterSelector).hide(),$tppServer.find(settings.loadingSelector).hide(),$tppServer.find(settings.errorSelector).show()},$.ajax(ajax)},serverListInstallNow=(serverListAjax(),function(){$tppServer.on("click",settings.listSelector+" "+settings.installSelector,function(e){e.preventDefault();var $this=$(this),installNow=settings.installNow,e=$this.attr("href"),loading=$(installNow.loadingHtml);$this.hasClass("installing")||($this.html(loading).addClass("installing"),(loading=installNow.ajax).url=settings.url,loading.data.pProduceUrl=e,loading.data[settings.formToken]=1,loading.success=function(result){result.success&&$this.addClass("disabled").html(installNow.installedHtml),result.data.redirect?location.href=result.data.redirect:location.href=settings.url+"&view="+settings.view+"&layout="+settings.layout},$.ajax(loading))})});serverListInstallNow()},$.tppServerList.defaults={url:"index.php?option=com_tz_portfolio_plus",view:"addon",layout:"upload",loading:"",iframeHtml:"",formToken:"",filterSelector:".js-stools",filListSelector:"[name^=list]",loadingSelector:"[data-tpp-loading]",errorSelector:"[data-tpp-error]",pagSelector:"[data-tpp-pagination]",pagItemSelector:"[data-tpp-limitstart]",listSelector:"[data-tpp-extension-list]",installSelector:".install-now",ajax:{type:"POST",dataType:"json",data:{format:"ajax",layout:"upload_list_item"}},installNow:{loadingHtml:"",installedHtml:"",ajax:{type:"POST",dataType:"json",data:{task:"addon.ajax_install"}}}},$.fn.tppServerList=function(options){if("object"==typeof(options=void 0===options?{}:options))return this.each(function(){void 0===$(this).data("tppServerList")?new $.tppServerList(this,options):$(this).data("tppServerList")})}}(jQuery);